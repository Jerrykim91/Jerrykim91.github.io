---
title: 5.Python_Analytics_func
author: Jerry
date: 2022-04-06 
category: Data Analytics #Data Analytics
layout: post
---

<h5><p align="right"> {{ page.date | date_to_string }} </p></h5>
<!-- ì½”ë“œ ìƒë‹¨ :  -->
<a href="https://hits.seeyoufarm.com">
<img align="right" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://github.com/Jerrykim91/jerrykim91.github.io"/></a> 


<br>

#### 5. ìì£¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ - Python_Analytics_func


<br>

# ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ë¶„ì„ í•¨ìˆ˜ 

<br>


<!-- https://velog.io/@findingflow/%EC%9E%90%EB%A3%8C-%EC%9C%A0%ED%98%95%EC%97%90-%EB%94%B0%EB%A5%B8-%ED%86%B5%EA%B3%84-%EB%B6%84%EC%84%9D -->



## 1. ì—°ë„ ê³„ì‚°

<br>


### 1) ê¸°ë³¸í˜•

```py
# ì—°ë„ ê³„ì‚°
for mth in range(1,13):
    ThirtyOne = [1,3,5,6,7,9,12] 
#     print(mth)
    if mth == 2 :
        for dt in range(1,30):
            print(dt)

    elif mth not in ThirtyOne :
        for dt in range(1,31):
            print(dt)

    else:
        for dt in range(1,32):
            print(dt)
        print('='*60)
```

<br>

### 2) í•¨ìˆ˜í˜•

```py
def make_date(date): # date

    year = str(date.year)
    # month
    if date.month >= 10:
        month = str(date.month)
    else:
        month = "0" + str(date.month)
    # day
    if date.day >= 10 :
        day = str(date.day)
    else:
        day = "0" + str(date.day)

    # hour
    hour = str(date.hour)

    f_date = year + "." + month + "." + day + "." + hour + ":00"
    return f_date
```

<br><br>


## 2. Translation_ language detection - í•¨ìˆ˜í™”

<br>

```py

#  í•¨ìˆ˜í™” 1
# 1. íŒŒì¼ ë¦¬ìŠ¤íŠ¸ íšë“
import glob
import os, re

try:
    path = './input/train/*.txt'
    file_list = glob.glob(path)
    print('ì •ìƒì‘ë™',file_list)
except Exception as e :
    print('ì—ëŸ¬ë°œìƒ', e)

# get_data() í•¨ìˆ˜
def get_data(file_path):

    # 2. ì–¸ì–´ ì½”ë“œ í™•ë“ file_path
    base_name = os.path.basename(file_path)
    # ì •ê·œì‹ ì‚¬ìš©
    p = re.compile('^[a-z]{2}')
    lng_code = p.match(base_name).group()


    # 3. íŒŒì¼ì„ ì—´ë©´ì„œ ì •ê·œí™”
    try:
        with open( file_path, encoding='utf-8') as f :
            # ë‘ë²ˆì§¸ ì •ê·œì‹
            text = f.read().lower() # ì†Œë¬¸ìë¡œ ë°”ê¿”ì„œ ì¶œë ¥
            p = re.compile('[^a-z]*')
            text = p.sub('', text)
        # ë¡œê·¸
        print('ì •ìƒì‘ë™', f,'\n','='*70 )

    except Exception as e:
        # ë¡œê·¸
        print('ì—ëŸ¬ë°œìƒ', e)


    # 4. ì•ŒíŒŒë²³ ê·¸ë¦‡ ë§Œë“¤ê¸° 26 ê°œ
    counts = [0] * 26
    ASCII_A = ord('a')
    for i in text:
        counts[(ord(i)-ASCII_A)] += 1

    # í•©ì¹˜ê¸°
    total_counts = sum(counts)  
    # 5. ëŒë‹¤ë¥¼ ì´ìš©í•´ ë¹ˆë„ìˆ˜ ì—°ì‚°í•˜ê¸°
    frequences = list(map(lambda x:x/total_counts, counts)) # ì•ŒíŒŒë²³ ê°¯ìˆ˜

    # lang_code   :  ì–¸ì–´ ì½”ë“œ
    # frequences  :  ì•ŒíŒŒë²³ ë³„ë¡œ ë‹´ê¸´ í‰ê·  ë¹ˆë„ìˆ˜  
    #     => ì•ŒíŒŒë²³ë³„ ë¹ˆë„/ì´ ë¹ˆë„(= ì´ ì•ŒíŒŒë²³ ë¬¸ìì—´ ê°œìˆ˜)


    # ê²°ê³¼ê°’ ë¦¬í„´
    return lng_code, frequences


# í›ˆë ¨ìš© ë°ì´í„°, í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ë¡œë“œ
# ì¤‘ê°„ê²½ë¡œê°€ train í˜¹ì€ test

# path = 'train'
# load_data()í•¨ìˆ˜
def load_data(path = 'train'):

    # íŒŒì¼ê²½ë¡œ => formatìœ¼ë¡œ í• ë‹¹
    file_boxs = glob.glob('./input/{}/*txt'.format(path))

    # ë¦¬ìŠ¤íŠ¸
    labels = list()
    freqs  = list()


    # í•˜ë‚˜ì”© ì¶œë ¥
    for box in file_boxs:
        # 1ê°œë‹¹ ì •ë‹µ, ë¹ˆë„ìˆ˜ë¦¬ìŠ¤íŠ¸ ë¦¬í„´
        lng,freq = get_data(box)
        labels.append( lng )
        freqs.append( freq )

    # ë¦¬í„´í•˜ëŠ”ë° ì œì´ìŠ¨ í˜•ì‹ìœ¼ë¡œ ë°°í¬
    return {'labels ':labels , 'freqs': freqs }
    #  #  {'labels':['en','fr'], 'freqs': [[],[]

# êµ¬ë²„ì „ - ë²„ê·¸ë°œìƒ => inputì˜ ì—­í™œ ì¸ì§€ ë¯¸ìˆ™
# def try_load( name, option, encoding='utf-8'):
#     # ë¬¸ìì—´ ì•ˆë‚˜ì˜¤ê²Œ í•˜ë ¤í–ˆëŠ”ë° => ë³€ìˆ˜ë¡œ ë°›ì•„ë“¤ì—¬ì„œ ì‹¤íŒ¨
#     # ë™ì‘ì€ í•˜ì§€ë§Œ

#     file_path = './input/' + '{}.json'.format(name)

#     try:
#         with open( file_path , option) as f:
#             if option == 'w' :
#                 input_data = input('ë¤í”„ì‹œí‚¬ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”')
#                 json.dump(input_data,f)

#             elif option == 'r' :  
#                 tmp = json.load(f)
#                 print('\nê¸¸ì´ =', len(tmp))

#         print('ì •ìƒë™ì‘')

#     except Exception as e:
#         print('ì—ëŸ¬ë°œìƒ', e )

#     return


# try_load()í•¨ìˆ˜
def try_load( name, option, encoding='utf-8'):
    # ì´ì „ í•¨ìˆ˜ëŠ” nameì´ ë­˜ ì´ì•¼ê¸°í•˜ëŠ” ì¤„ ëª°ëìŒ -> ê·¸ë¦¬ê³  ê²½ë¡œê°€ ë„ˆë¬´ ì§€ì €ë¶„í•´ì„œ ë‚´ë¶€ì— ìƒëŒ€ê²½ë¡œë¥¼ ì¶”ê°€ ì¡°ê¸ˆì€ ì´í•´í•˜ê¸° ì‰½ë„ë¡ í’€ì–´ì„œ ì‘ì„±
    file_path_input  = './input/'
    file_path = file_path_input + '{}.json'.format(name)

    # ì˜ˆì™¸ì²˜ë¦¬ ì§„í–‰
    try:
        # ë‘ê°€ì§€ ì¼€ì´ìŠ¤ë¥¼ í•œ withë¬¸ì— ë‹´ìŒ
        with open( file_path , option) as f:
            # ë§Œë“¤ê¸° + json íŒŒì¼ ìƒì„±
            if option == 'w' :
                train_data = load_data('train') # load_dataí•¨ìˆ˜ë¡œ train ë°ì´í„° ë¶ˆëŸ¬ì˜´
                test_data  = load_data('test')# load_dataí•¨ìˆ˜ë¡œ test ë°ì´í„° ë¶ˆëŸ¬ì˜´
                data = [train_data, test_data] # ìœ„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€ê²½ í›„ ë³€ìˆ˜ì— ë‹´ìŒ
                # print(type(data)) # ë°ì´í„° íƒ€ì… í™•ì¸
                json.dump(data,f) # ë¤í”„
            # ì½ê¸° + jsoníŒŒì¼ ì½ì–´ì˜¤ê¸°
            elif option == 'r' :  
                tmp = json.load(f) # ë¡œë“œëœ íŒŒì¼ì„ tmpì— ë‹´ê¸°
                # print(tmp) # ë°ì´í„° í™•ì¸
                print('\nê¸¸ì´ =', len(tmp))  # ë°ì´í„° í™•ì¸ ê¸¸ì´í™•ì¸ê²¸ ì •ìƒ ë°ì´í„°ì¸ì§€ íŒë³„
                return tmp  # ê°’ì„ ë¦¬í„´

        print('ì •ìƒë™ì‘')

    except Exception as e:
        print('ì—ëŸ¬ë°œìƒ', e )

    return  



# train_data = load_data()
# test_data  = load_data('test')
# get_data()
# try_load('test_data', 'w')

# sklearn
from sklearn import svm, metrics
from sklearn.externals import joblib

try_load('test_data', 'w')
freq = try_load('test_data', 'r')

print(len(freq[0]['labels']),len(freq[0]['freqs']))
print(len(freq[1]['labels']),len(freq[1]['freqs']))


clf = svm.SVC( gamma = 'auto' )
clf.fit(freq[0]['freqs'],freq[0]['labels'])
predict = clf.predict(freq[1]['freqs'])
# print(predict)
metrics.classification_report(freq[1]['labels'], predict )

try:
    joblib.dump(clf,'./output/clf_lang_20200310.model')
except Exception as e:
    print('ì—ëŸ¬ë°œìƒ', e )

label_dic = {
    'en':'ì˜ì–´',
    'fr':'í”„ë‘ìŠ¤ì–´',
    'tl':'íƒ€ê°ˆë¦¬ì•„ì–´',
    'id':'ì¸ë„ë„¤ì‹œì•„ì–´'
}

try:
    with open('clf_labels.json', 'w', encoding='utf-8' ) as f:
    json.dump(label_dic, f)
    print('ì •ìƒë™ì‘')

except Exception as e:
    print('ì—ëŸ¬ë°œìƒ', e )

```

<br>



## 3. ì´ë™ í‰ê· ì„ 

<br>

```py

```

<br>


## 4. ë°ì´í„° ê·¸ë£¹í™” í›„ í‰ê·  - ver2 

<br>

```py

def stack_mean_ver2(df, col_srt, col_end):
    dic_lot = dict()
    for col in df.columns[int(col_srt):int(col_end)]:
        dic_lot[col] = df[f'{col}'].mean()
        df_mean = pd.DataFrame(dic_lot.values(), index=dic_lot.keys())
        df_mean = df_mean.T
        
    return  df_mean
    

```

<br>


## 4. [sample] ë°ì´í„° ë¡œë“œ ê´€ë ¨ í•¨ìˆ˜ 

<br>

```py

def dataLoad(dataFullPath=None, DBInfo=None):

    if dataFullPath != None:
        dataType = dataFullPath.split('.')[1]
        # print(dataType) # DEV
        if dataType == 'csv':
            df = pd.read_csv(dataFullPath)
            # print(len(df)) # DEV
        elif dataType == 'xlsx':
            df = pd.read_excel(dataFullPath)
        elif dataType == 'json':
            pass
        else:
            print(dataType) # DEV
    else:
        if DBInfo != None:
            if type(DBInfo) == type(list()):
                df = DB2DataFrame(DBInfo)
                print(type(df))
            else:
                return 'DB infomation Type Check plz'
        pass
    
    return df

```

<br>

```py
# for i in range(6):
#     globals()['val_{}'.format(i)] = i

# for i in range(6):
#     print(globals()['val_{}'.format(i)])

# class test:
#     def __init__(self):
#         for i in range(5):
#             globals()['self.val_{}'.format(i)] = i*3
    
#     def printvals(self):
#         for i in range(5):
#             print(globals()['self.val_{}'.format(i)])

# t = test()
# t.printvals()
```

<br>

## 10.

<br>

```py

```

<br>





<br>

---

<br>

## Reference <br>

<!-- ì½”ë§¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸ -->
<br>
<script src="https://utteranc.es/client.js"
    repo="Jerrykim91/jerrykim91.github.io"
    issue-term="title"
    label="ğŸ˜"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
<br>