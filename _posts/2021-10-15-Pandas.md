---
title: Data Analytics - Pandas(íŒë‹¤ìŠ¤)
author: Jerry
date: 2021-10-15 09:00:00 +0800
category: Data Analytics
layout: post
---
<!-- ì½”ë“œ ìƒë‹¨ :  -->
<a href="https://hits.seeyoufarm.com">
<img align="right" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://github.com/Jerrykim91/jerrykim91.github.io"/></a> 


<!-- <br>

#### 1. Data Analytics - íŒë‹¤ìŠ¤, Pandas

<br><br> -->

# 1. Data Analytics - Pandas(íŒë‹¤ìŠ¤)

ì£¼ë¡œ ì“°ëŠ” ì¸ì½”ë”© `euc-kr, utf-8, CP949, utf-8-sig`

<br>

## 1. ë°ì´í„° ë¡œë“œ ë°©ë²• 


### 1) í¬ë§·íŒ… í˜•ì‹

```py
path = './data/%s.csv' 
df = pd.read_csv(path %'íŒŒì¼ì´ë¦„')
```

<br>

### 2) os ì™€ globì„ ì´ìš©í•˜ì—¬ pathë¥¼ ê°€ì ¸ì™€ ë°ì´í„°ë¡œë“œí•˜ëŠ” ë°©ì‹

- os, globì˜ ìì„¸í•œ ë‚´ìš©ì€ 4ì¥ì—ì„œ!

<br>

```py
import os
import glob

## 1ë²ˆ ë°©ë²• 
# ë³€ìˆ˜ì— ê²½ë¡œí• ë‹¹
path = 'C:/data/'
df = pd.read_csv(glob.glob(path+'*')[0])

## 2ë²ˆ ë°©ë²• 
# í˜„ì¬ ë‚´ ê²½ë¡œ 
os.getcwd()
# ['C:\\stock']

# ë°ì´í„° ê²½ë¡œ 
dirpaths = glob.glob(os.getcwd()+"/data"+"/*")
# ['C:\\stock/data\\ìƒì¥ë²•ì¸ëª©ë¡.xls']
df = pd.read_csv(dirpaths[0]) 

# ê²½ë¡œ ë‚´ì— ë°ì´í„° ë¦¬ìŠ¤íŠ¸ í™•ì¸ 
os.listdir(os.getcwd()+"/data")
# ['ìƒì¥ë²•ì¸ëª©ë¡.xls']
```
<br>

ìœ„ ì½”ë“œëŠ” ë°ì´í„° ê°œìˆ˜ê°€ ë³€ê²½ë˜ë©´ ìˆ˜ì • í•´ì•¼í•´ì•¼í•œë‹¤ëŠ” ë²ˆê±°ë¡œì›€ì´ ìˆë‹¤. 

ê°œì¸ì ìœ¼ë¡œ ì´ ë°©ì‹ì´ ì¢‹ì€ ë°©ì‹ì´ ì•„ë‹Œ ê²ƒì€ ì•Œì§€ë§Œ ì˜¤íƒ€ë°©ì§€ìš©ìœ¼ë¡œ ë§ì´ ì‚¬ìš©í•œë‹¤. 

<!-- ### 3)  -->


<br><br>


## 2. ë°ì´í„° í™•ì¸ 


### 1) ê¸°ë³¸ ì •ë³´í™•ì¸ 

```py
# info 
df.info()

# shape   ->  ë°ì´í„° ê¸¸ì´ (ì¸ë±ìŠ¤, ì»¬ëŸ¼)
df.shape

# columns ->  ì»¬ëŸ¼ì¢…ë¥˜
df.columns
```

<br>


### 2) íŠ¹ì • ìœ„ì¹˜ ì •ë³´ í™•ì¸ 

ì›í•˜ëŠ” ìœ„ì¹˜ì˜ ì»¬ëŸ¼ê³¼ ì¸ë±ìŠ¤ ê¸¸ì´ë¥¼ í™•ì¸í•œë‹¤. 

```py 
idxNum = 10        # ì¸ë±ìŠ¤ ê¸¸ì´
colsLen = [0,2,-1] # ì»¬ëŸ¼ ìœ„ì¹˜ê°’ 

# ì›í•˜ëŠ” ìœ„ì¹˜ì˜ ì»¬ëŸ¼ê³¼ ì¸ë±ìŠ¤ ê¸¸ì´ë¥¼ í™•ì¸ 
df.iloc[:idxNum, colsLen]
```
<br>

### 3) ë°ì´í„° ì •ë³´ ì‰½ê²Œ ë³´ê¸° 

ë°ì´í„° ì •ë³´ `dict`ì— ë‹´ê¸°
êµ³ì´ í•  í•„ìš”ëŠ” ì—†ì§€ë§Œ ìˆ˜ì‹œë¡œ ì •ë³´ ì°¾ì•„ë³´ê¸° ë¶ˆí¸í•´ì„œ

```py
idx = ['ì •ë³´', 'ëœ»'] # ì»¬ëŸ¼ì •ë³´
cols_info=dict()
for i,j in zip(train.columns[1:],idx):
    cols_info[i]=j

print('done')
cols_info # ë³€ìˆ˜ì— ì •ë³´ê°€ ë‹´ê¹€
```
<br><br>


## 3. ê²°ì¸¡ê°’ í™•ì¸í•˜ëŠ” ì½”ë“œ 


### 1) ë„ê°’ í™•ì¸ 

```py
# ë°ì´í„° í”„ë ˆì„ì˜ ì „ì²´ ë„ê°’ í™•ì¸ 
df.isnull().sum()

# ê²°ì¸¡ì¹˜ì¸ ì•„ì´ë§Œ ì¶œë ¥ 
df[df.'ì»¬ëŸ¼ì´ë¦„'.isnull()==True]

```

<br>

### 2) ë„ê°’ í™•ì¸ ë° ì œê±° 

```py
cols_info = {
            'patient_id': 'í™˜ì ID',
            'sex': 'ì„±ë³„',
            'age': 'ë‚˜ì´',
            'country': 'êµ­ì '}

# ê²°ì¸¡í™•ì¸ 
for col in df.columns:
    print(f'{cols_info[col]} = ', df[col].isnull().sum())

# ê²°ì¸¡ ë¹„ìœ¨í™”
for col in df.columns:
    percent = df[col].isnull().sum() / df[col].shape[0]
    msg = 'column: {:>20}\t Percent of NaN value: {:.2f}%'.format(col, 100 * (percent))
    print(msg)
```

### 3) ë„ê°’ ì²˜ë¦¬ ê°€ì´ë“œ ë¼ì¸ 

```py
col_name = list()
for idx,col in enumerate(df.columns):
    percent = df[col].isnull().sum() / df[col].shape[0]
    if df[col].isnull().sum() != 0: # ê²°ì¸¡ì´ ì—†ëŠ”ê²ƒì„ ì œì™¸í•˜ê³  ì¶œë ¥ 
        print(cols_info[col])
        if percent <= 0.09:
            msg = 'column: {:>2} | Percent of NaN value: {:.2f}%'.format(col, 100 * (percent))
            print(msg, '# 10% ë¯¸ë§Œ ì‚­ì œ or ëŒ€ì¹˜')
        elif  0.1< percent < 0.5:
            msg = 'column: {:>2} | Percent of NaN value: {:.2f}%'.format(col, 100 * (percent))
            print(msg,'# 10~50% Regression or Model based imputation ')
        else:
            msg = 'column: {:>2} | Percent of NaN value: {:.2f}%'.format(col, 100 * (percent))
            print(msg,' # 50% ì´ìƒ ì‚­ì œ ëŒ€ìƒ ')
    else:
        pass
```

<br><br>

## 4. `dict()` ì •ë ¬(ë”•íŠ¸ì •ë ¬)


`list()` ì•ˆì˜ ì¤‘ë³µê°’ì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•˜ê³  ì¤‘ë³µìˆ˜ì— ë”°ë¼ ìˆœìœ„ë¥¼ í™•ì¸í•˜ì í•œë‹¤. 

ê·¸ë˜ì„œ `dict()`ë¥¼ ì´ìš©í•˜ì—¬ ì‘ì—…ì„ ì§„í–‰ 
- ë¦¬ìŠ¤íŠ¸ì•ˆì˜ ì¤‘ë³µëœ ê°’ì˜ ê°œìˆ˜


```py
data = dict()
for cnt in allData:
    try: data[cnt] += 1
    except: data[cnt]=1
```

<br>

dataëŠ” ì¤‘ë³µê°’ê³¼ ê·¸ ì¤‘ë³µê°’ì˜ ê°œìˆ˜ë¥¼ ë³´ì—¬ì¤€ë‹¤.     

ì´ë ‡ê²Œ ë§Œë“¤ì–´ì§„ dataë¥¼ `sorted(data)` ì´ìš©í•´ ì •ë ¬í•œë‹¤.      

í™•ì¸í•´ ë³´ë‹ˆ defult ê°’ ì˜¤ë¦„ì°¨ìˆœì´ë©° keys ê¸°ì¤€ì´ë¼ ì˜µì…˜ì„ ì´ìš©í•´ vaules ê¸°ì¤€ìœ¼ë¡œ ê·¸ë¦¬ê³  ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ë³€ê²½í•œë‹¤.      

ì—¬ê¸°ì„œ ì˜¤ë¦„ì°¨ìˆœì„ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ë³€ê²½í•˜ëŠ”ê²ƒì€ 
`sorted(data,reverse=True)` ë¥¼ ì´ìš©í•˜ë©´ ë˜ì§€ë§Œ 

keys ê¸°ì¤€ì„ vaules ê¸°ì¤€ìœ¼ë¡œ ë°”ê¾¸ëŠ”ê²ƒ ê°™ì´ íŠ¹ì • ê¸°ì¤€ì„ ë³€ê²½í•˜ëŠ”ê²ƒì€ ë”°ë¡œ íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ì—¬ ì§„í–‰í•´ì•¼í•œë‹¤. ë‹¤í–‰íˆë„ ë²ˆê±°ë¡­ê²Œ ì„¤ì¹˜ í•  í•„ìš”ëŠ” ì—†ë‹¤.

`import operator` ë¥¼ ì´ìš©í•˜ì—¬ ì§„í–‰í•˜ë©´ ëœë‹¤.

operatorì˜ ìì„¸í•œ ë‚´ìš©ì€ [ì°¸ê³ ](https://docs.python.org/ko/3.7/library/operator.html) í™•ì¸í•´ë³´ë©´ëœë‹¤.   

ì—¬ê¸°ì„œ `itemgetter()` ì•ˆì— ë“¤ì–´ê°€ëŠ” ìˆ˜ëŠ” `0` ì€ í‚¤ ê¸°ì¤€ , `1` ê°’ ê¸°ì¤€ì´ë‹¤. 

ì„í¬íŠ¸ë¥¼ í•œ í›„ ì´ë ‡ê²Œ í•¨ìˆ˜ ë‚´ë¶€ì— íŒŒë¼ë¯¸í„° ê°’ì„ `key=operator.itemgetter(1)` ìœ¼ë¡œ ì§€ì •í•˜ë©´ vaules ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœì˜ ë°ì´í„°ë¥¼ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.         

```py
sorted(data.items(),reverse=True, key=operator.itemgetter(1))
``` 
íƒ€ì´ì„ í™•ì¸í•´ë³´ë©´ `list`ë¡œ í˜•ì‹ìœ¼ë¡œ ë‹´ê¸°ê²Œ ë˜ëŠ”ë° ì¸ë±ì‹±ì„ ì´ìš©í•˜ì—¬ ì›í•˜ëŠ” í˜•íƒœë¡œ ì¶”ì¶œì´ ê°€ëŠ¥í•˜ë‹¤.      

<br><br>

 
## 5.  ë°ì´í„° í”„ë ˆì„ ìƒì„± 


### 1 ) ë³´ìœ  ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° í”„ë ˆì„ ìƒì„± 

`list`, `dict` ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° í”„ë ˆì„ ìƒì„± 

```py
data = dict() or list()

df = pd.DataFrame(data) # í”„ë ˆì„ ìƒì„± 

print(df)
```

<br>


### 2 ) ìƒì„±, í™œìš©í•´ì„œ ë°ì´í„° í”„ë ˆì„ ìƒì„±      

<br>

ë°ì´í„°ë¥¼ ìƒì„± í˜¹ì€ í™œìš©í•´ì„œ ë°ì´í„° í”„ë ˆì„ ìƒì„±      

ë¦¬ìŠ¤íŠ¸ë‚´í¬ë¥¼ ì´ìš©í•´ì„œ 

```py
df_data = pd.DataFrame( columns = ("fst","sed","trd") )

df_data_1 = df_data
for i in range(5):
    df_data_1.loc[i] = [(i+1)*(n+1) for n in range(3)]

print(df_data_1)
```

<br>

### 3 ) ë°ì´í„° í”„ë ˆì„ ìƒì„± í›„ íŠ¹ì • ì»¬ëŸ¼ ì¶”ê°€ 

<br>

íŠ¹ì • ì»¬ëŸ¼ì— ë°ì´í„° ì¶”ê°€

```py
df_data = pd.DataFrame( columns = ("fst","sed","trd") )

# íŠ¹ì • ì»¬ëŸ¼ì— ë°ì´í„° ì¶”ê°€ 
df_data_2 = df_data
df_data_2.trd = [date]

print(df_data_2)
```

<br><br>

## 6. ë°ì´í„° ë³‘í•© 


íŒë‹¤ìŠ¤ì™€ for ë¬¸ì„ ì´ìš©í•´ ë°ì´í„° ë³‘í•©

```py
pathName = 'C:\data\%s' 

dataList = list()
cnt = 0
# glob ê²½ë¡œë¥¼ ì¶”ì¶œ -> ê²½ë¡œë¥¼ read_csv
for pth in glob.glob(pathName%'Camp'+'/*'):
    # read_csvë¥¼ ì´ìš©í•´ íŒŒì¼ì„ ì½ì–´ì„œ ë³€ìˆ˜ì— ë‹´ëŠ”ë‹¤ 
    origin  = pd.read_csv( pth, index_col=False)
    cnt = cnt + len(origin) # ë°ì´í„° ê²€ì¦ì„ ìœ„í•œ ëˆ„ì ì½”ë“œ
    
    print(cnt)
    dataList.append(origin)

# ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸´ ë°ì´í„°í”„ë ˆì„ì„ concatì„ ì´ìš©í•´ ë³‘í•©í•œí›„ csvë¡œ ì €ì¥ 
CatList= pd.concat(dataList,axis=0, ignore_index=True)
# axis=0ì€ ìˆ˜ì§, axis=1ì€ ìˆ˜í‰ìœ¼ë¡œ ë³‘í•©
# ignore_index=TrueëŠ” ìˆœì„œë¥¼ ë¬´ì‹œí•˜ê³  ìˆœì„œëŒ€ë¡œ ì •ë ¬
CatList.to_csv('C:/data/%s.csv'% f'Camp', index=False, mode='w', encoding='utf-8')
```

<br><br>


## 7. ì—¬ëŸ¬ê°œ ë¬¸ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìì—´ ìë¥´ê¸° 


### 1) `re.findall()`ì„ ì´ìš©í•˜ëŠ” ë°©ë²• 

- `re.findall(pattern, string, flags=0)`ì„ ì“°ëŠ” ë°©ë²•

```py
import re
DATA = "Hey, you - what are you doing here!?"
print re.findall(r"[\w']+", DATA)
# Prints ['Hey', 'you', 'what', 'are', 'you', 'doing', 'here']
```
<br>

### 2) `re.split()`ì„ ì´ìš©í•˜ëŠ” ë°©ë²• 

- `re.split(pattern, string[, maxsplit=0])`ì„ ì“°ëŠ” ë°©ë²•

```py
import re
DATA = "Hey, you - what are you doing here!?"
print re.split('\W+', DATA) # ['Hey', 'you', 'what', 'are', 'you', 'doing', 'here', '']
```

<br>

### 3)` replace()`í•œ í›„ `split()`í•˜ëŠ” ë°©ë²•

- `replace()`ì™€ `split()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìì—´ì„ ìë¥¼ ìˆ˜ ìˆë‹¤. 

```py
'a;bcd,ef g'.replace(';',' ').replace(',',' ').split() = ['a', 'bcd', 'ef', 'g']
```

<br><br>

## 8. ì»¬ëŸ¼ ê°€ì§€ê³  ë†€ê¸°


### 1) ì»¬ëŸ¼ ìœ„ì¹˜ ë³€ê²½

```py
# ì»¬ëŸ¼ ìœ„ì¹˜ë¥¼ ë³€ê²½ í•˜ê³ ì í•  ë•Œ 
df = df[['ì»¬ëŸ¼ì´ë¦„1', 'ì»¬ëŸ¼ì´ë¦„2']]
```
<br>

### 2) ì»¬ëŸ¼ ì¶”ê°€ 

```py
# ìƒˆë¡œìš´ ì»¬ëŸ¼ì„ ì¶”ê°€
df['ìƒˆì»¬ëŸ¼ì´ë¦„1'] = 'WoW'  # 1

# ìƒˆ ì»¬ëŸ¼ 0ìœ¼ë¡œ ì±„ìš°ê¸°
df.loc[:,'ìƒˆì»¬ëŸ¼ì´ë¦„1'] =  '0'  # 2

# ë¦¬ìŠ¤íŠ¸ë¡œ ì±„ìš°ê¸°
df.loc[:,'ìƒˆì»¬ëŸ¼ì´ë¦„1'] =  ['ê°™ì´ ë“¤ì–´ê°ˆ ë‚´ìš©']  # 3
```
<br>

### 3)

```py
```

<br>


### 4) ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½í•˜ê¸° 

```py
# 1. ì»¬ëŸ¼ ê°œìˆ˜ë¥¼ í™•ì¸  - ê°œìˆ˜ì— ë§ê²Œ ë°”ê¿”ì•¼í•¨
df.columns = ['ì»¬ëŸ¼ì´ë¦„1', 'ë°”ê¾¼ì´ë¦„']  # ì»¬ëŸ¼ 2ê°œ ì¼ ê²½ìš° 

# 2. rename() funcì„ ì´ìš©í•œ ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½
df = df.rename(columns={'ì»¬ëŸ¼ì´ë¦„1': 'ë°”ê¿€ì´ë¦„', 'ì»¬ëŸ¼ì´ë¦„2': 'ë°”ê¿€ì´ë¦„'})
```
<br><br>

## 9. ì—‘ì…€ ë°ì´í„° ì‹œíŠ¸ ì—¬ëŸ¬ê°œ ì¼ë•Œ ì¶œë ¥ 


ë§ ê·¸ëŒ€ë¡œ ì—‘ì…€íŒŒì¼ì€ í•˜ë‚˜ì§€ë§Œ ì‹œíŠ¸ê°€ ì—¬ëŸ¬ì¥ì¼ ê²½ìš° ì´ ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ë¡œ í•  ìˆ˜ ìˆë‹¤.  

```py
# ë°ì´í„° ì‹œíŠ¸ ì—¬ëŸ¬ê°œ ì¼ë•Œ ì¶œë ¥ 
sheet_Name = [
    '2015 ë¶€ì‚° ê°•ìˆ˜ëŸ‰', '2016 ë¶€ì‚° ê°•ìˆ˜ëŸ‰',
    '2017 ë¶€ì‚° ê°•ìˆ˜ëŸ‰', '2018 ë¶€ì‚° ê°•ìˆ˜ëŸ‰',
    '2019 ë¶€ì‚° ê°•ìˆ˜ëŸ‰', '2020 ë¶€ì‚° ê°•ìˆ˜ëŸ‰' ]

def read_exel(xlse_path, sheet_Name) :
    exel_file = pd.ExcelFile(xlse_path)
    data = exel_file.parse(sheet_Name)
    return data

# data = read_exel(data_path, sheet_Name[])
```

<br><br>


## 10. í”¼í´ 


### 1) í”¼í´ - ìƒˆë¡œë§Œë“¤ê¸°  

```py 
import pickle # ëª¨ë“ˆë¶ˆëŸ¬ì˜¤ê¸° 

# save data
with open( 'íŒŒì¼ì´ë¦„'+'.pickle','wb') as fw:
    pickle.dump(stockInfo, fw)
    
```

<br>

```py

```

<br>





<br>

---

<br>

## Reference <br>

- HashCode &nbsp; : &nbsp;<https://hashcode.co.kr/questions/493/%EC%97%AC%EB%9F%AC%EA%B0%9C-%EB%AC%B8%EC%9E%90%EB%A5%BC-%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C-%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%84-%EC%9E%90%EB%A5%B4%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%9D%B4-%EC%9E%88%EB%82%98%EC%9A%94> <br>

<!-- <br>
<br>

## Practice makes perfect! <br> -->

<!-- - [ë‚´ìš©](ì£¼ì†Œ) -->


<!-- ì½”ë“œ í•˜ë‹¨ -->
<br>
<script src="https://utteranc.es/client.js"
    repo="Jerrykim91/jerrykim91.github.io"
    issue-term="title"
    label="ğŸ˜"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
<br>